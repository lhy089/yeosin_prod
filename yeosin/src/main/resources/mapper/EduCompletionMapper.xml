<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yeosin.user.EduCompletionDao" >
	
	<select id="getEduCompletionInfo" parameterType="String" resultType="String">
      SELECT 
			(
				CASE
					WHEN EXISTS (
						SELECT 
							1
						FROM YS_EDUCOMPLETION EC
						WHERE EC.USERNAME = #{userName}
							AND EC.BIRTHDATE = #{birthDate}
							AND EC.GENDER = #{gender}
							AND EC.SUBJECT = #{subject}
						)
					THEN 'Y'
					ELSE 'N'
				END
			) as EXISTS_YN
		FROM DUAL
   </select>
   
	<!-- 로그인 유저의 교육증 수료여부 조회 -->
	<select id="getisUserEdu" parameterType="map" resultType="String">
		SELECT 	CASE WHEN COUNT(*) > 0 
					 THEN 'Y' 
					 ELSE 'N' END 		AS ISEDUPASS
		FROM 	YS_EDUCOMPLETION 
		WHERE 	1 = 1
		AND 	USERNAME = #{userName, jdbcType=VARCHAR}
		AND		GENDER = #{gender, jdbcType=VARCHAR}
		AND 	BIRTHDATE = #{birthDate, jdbcType=VARCHAR}
		AND 	CERTID = #{eduNum, jdbcType=VARCHAR};
	</select>
	
	<insert id="insertEduComepletionInfo" parameterType="com.yeosin.user.EduCompletionDto">
		INSERT INTO YS_EDUCOMPLETION
			(USERID, EDUUSERID, USERNAME, BIRTHDATE, GENDER, CERTID, SUBJECT)
		VALUES
			(#{userId}, #{eduUserId}, #{userName}, #{birthDate}, #{gender}, #{certId}, #{subject})
	</insert>
	
	<update id="updateEduComepletionInfo" parameterType="com.yeosin.user.EduCompletionDto">
		UPDATE YS_EDUCOMPLETION
		<set>
			CERTID = #{certId}
		</set>
		WHERE USERNAME = #{userName}
			AND BIRTHDATE = #{birthDate}
			AND GENDER = #{gender}
			AND SUBJECT = #{subject}
	</update>
	
	
</mapper>
