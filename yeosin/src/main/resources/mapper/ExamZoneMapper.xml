<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.yeosin.apply.ExamZoneDao" >
	
	<!-- 지역의 고사장 리스트 조회 -->
  	<resultMap id="ExamZoneListResultMap" type="com.yeosin.apply.ExamZoneDto">
		<result column="EXAMZONEID" property="examZoneId" />
		<result column="EXAMZONENAME" property="examZoneName" />
		<result column="LOCAL" property="local" />
		<result column="LOCALDETAIL" property="localDetail" />
		<result column="LOCALCENTERID" property="localCenterId" />
		<result column="EXAMROOMCNT" property="examRoomCnt" />
		<result column="EXAMROOMUSERCNT" property="examRoomUserCnt" />
 		<result column="LEFTOVERSEAT" property="leftOverSeat" />
		<result column="EXAMZONEMAP" property="examZoneMap" />
  		<association property="localCenterDto" javaType="com.yeosin.apply.LocalCenterDto">
			<result column="LOCALCENTERNAME" property="localCenterName" />
		</association>
	</resultMap>
	<select id="getExamZoneList" parameterType="map" resultMap="ExamZoneListResultMap">
		SELECT 	
				EZ.EXAMZONEID 													-- 고사장 ID
			,	EZ.EXAMZONENAME 												-- 고사장명
			,	EZ.LOCAL 														-- 지역 
			,	EZ.LOCALDETAIL 													-- 구
			,	EZ.LOCALCENTERID 												-- 지역센터 ID
			,	LC.LOCALCENTERNAME 												-- 지역센터명
			,	EZ.EXAMROOMCNT * EZ.EXAMROOMUSERCNT 		AS	LEFTOVERSEAT	-- 잔여좌석(TODO : 현재는 전체좌석, 추후에는 전체좌석 - 해당 고사장에 접수된 숫자만큼 마이너스해야함)	
			,	EZ.EXAMZONEMAP 													-- 약도
		FROM 	YS_EXAMZONE					EZ 	
		LEFT JOIN YS_LOCALCENTER			LC	ON 	EZ.LOCALCENTERID = LC.LOCALCENTERID 
		WHERE 	1 = 1
		AND 	EZ.LOCALDETAIL = #{examZoneDetail};
	</select>
   
</mapper>
